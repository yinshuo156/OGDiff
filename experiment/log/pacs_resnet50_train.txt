Loading path...
Save name: my_pacs_experiment
Save best test: False
Save later: False
Loading dataset...
Group length: 1
DataSet: PACS
Source domain: ['art_painting', 'cartoon', 'photo']
Target domain: ['sketch']
Known classes: ['dog', 'elephant', 'giraffe', 'guitar', 'horse', 'house', 'person']
Unknown classes: []
Batch size: 16
Number of task(domain): 3
Number of task(class): 3
Tasks per step: [3, 3, 3]
CrossVal: True
Loading models...
Network: resnet50
Number of epoch: 6000
Optimize method: SGD
Learning rate: 0.0002
Meta learning rate: 0.01
Without close set classifier: False
Without binary classifier: False
Share Parameter: False
Start training...
Epoch: 300 Acc: 0.9513 (Val)
Epoch: 300 Acc: 0.7791 (Test)
GPU: 0,1,2,3
Loading path...
Save name: my_pacs_experiment
Save best test: False
Save later: False
Loading dataset...
Group length: 1
DataSet: PACS
Source domain: ['art_painting', 'cartoon', 'photo']
Target domain: ['sketch']
Known classes: ['dog', 'elephant', 'giraffe', 'guitar', 'horse', 'house', 'person']
Unknown classes: []
Batch size: 16
Number of task(domain): 3
Number of task(class): 3
Tasks per step: [3, 3, 3]
CrossVal: True
Loading models...
Network: resnet50
Number of epoch: 6000
Optimize method: SGD
Learning rate: 0.0002
Meta learning rate: 0.01
Without close set classifier: False
Without binary classifier: False
Share Parameter: False
Start training...
Epoch: 300 Acc: 0.9562 (Val)
Epoch: 300 Acc: 0.7221 (Test)
Current best val accuracy is 0.9562 (Test: [{'test_acc': '0.7221', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7221 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 600 Acc: 0.9692 (Val)
Epoch: 600 Acc: 0.7804 (Test)
Current best val accuracy is 0.9692 (Test: [{'test_acc': '0.7804', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7804 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 900 Acc: 0.9708 (Val)
Epoch: 900 Acc: 0.7971 (Test)
Current best val accuracy is 0.9708 (Test: [{'test_acc': '0.7971', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7971 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 1200 Acc: 0.9756 (Val)
Epoch: 1200 Acc: 0.8160 (Test)
Current best val accuracy is 0.9756 (Test: [{'test_acc': '0.8160', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8160 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 1500 Acc: 0.9756 (Val)
Epoch: 1500 Acc: 0.8180 (Test)
Current best val accuracy is 0.9756 (Test: [{'test_acc': '0.8160', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8180', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8180 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 1800 Acc: 0.9773 (Val)
Epoch: 1800 Acc: 0.8150 (Test)
Current best val accuracy is 0.9773 (Test: [{'test_acc': '0.8150', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8180 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 2100 Acc: 0.9773 (Val)
Epoch: 2100 Acc: 0.8290 (Test)
Current best val accuracy is 0.9773 (Test: [{'test_acc': '0.8150', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8290', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8290 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 2400 Acc: 0.9773 (Val)
Epoch: 2400 Acc: 0.8399 (Test)
Current best val accuracy is 0.9773 (Test: [{'test_acc': '0.8150', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8290', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8399', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 2700 Acc: 0.9724 (Val)
Epoch: 2700 Acc: 0.8328 (Test)
Current best val accuracy is 0.9773 (Test: [{'test_acc': '0.8150', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8290', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8399', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 3000 Acc: 0.9756 (Val)
Epoch: 3000 Acc: 0.8287 (Test)
Current best val accuracy is 0.9773 (Test: [{'test_acc': '0.8150', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8290', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8399', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 3300 Acc: 0.9789 (Val)
Epoch: 3300 Acc: 0.8397 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 3600 Acc: 0.9773 (Val)
Epoch: 3600 Acc: 0.8379 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 3900 Acc: 0.9756 (Val)
Epoch: 3900 Acc: 0.8374 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 4200 Acc: 0.9773 (Val)
Epoch: 4200 Acc: 0.8310 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 4500 Acc: 0.9724 (Val)
Epoch: 4500 Acc: 0.8272 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 4800 Acc: 0.9756 (Val)
Epoch: 4800 Acc: 0.8330 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 5100 Acc: 0.9756 (Val)
Epoch: 5100 Acc: 0.8361 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8399 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 5400 Acc: 0.9756 (Val)
Epoch: 5400 Acc: 0.8447 (Test)
Current best val accuracy is 0.9789 (Test: [{'test_acc': '0.8397', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8447 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 5700 Acc: 0.9805 (Val)
Epoch: 5700 Acc: 0.8407 (Test)
Current best val accuracy is 0.9805 (Test: [{'test_acc': '0.8407', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8447 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 6000 Acc: 0.9805 (Val)
Epoch: 6000 Acc: 0.8402 (Test)
Current best val accuracy is 0.9805 (Test: [{'test_acc': '0.8407', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}, {'test_acc': '0.8402', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.8447 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
GPU: 0,1,2,3
Loading path...
Save name: my_pacs_experiment
Save best test: False
Save later: False
Loading dataset...
Group length: 1
DataSet: PACS
Source domain: ['art_painting', 'cartoon', 'photo']
Target domain: ['sketch']
Known classes: ['dog', 'elephant', 'giraffe', 'guitar', 'horse', 'house', 'person']
Unknown classes: []
Batch size: 16
Number of task(domain): 3
Number of task(class): 3
Tasks per step: [3, 3, 3]
CrossVal: True
Loading models...
Network: resnet50
Number of epoch: 6000
Optimize method: SGD
Learning rate: 0.0002
Meta learning rate: 0.01
Without close set classifier: False
Without binary classifier: False
Share Parameter: False
Start training...
Epoch: 300 Acc: 0.9513 (Val)
Epoch: 300 Acc: 0.7389 (Test)
Current best val accuracy is 0.9513 (Test: [{'test_acc': '0.7389', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7389 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
